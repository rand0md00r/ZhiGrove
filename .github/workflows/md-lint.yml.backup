name: Markdown Lint

on:
  pull_request:
    branches: [ main, master ]
  push:
    branches: [ main, master ]
  workflow_dispatch:

jobs:
  mdlint:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Debug info
        run: |
          echo "Repository: ${{ github.repository }}"
          echo "Branch: ${{ github.ref }}"
          echo "Event: ${{ github.event_name }}"
          echo "Working directory: $(pwd)"
          echo "Files in current directory:"
          ls -la
          echo "Markdown files found:"
          find . -name "*.md" -type f | head -10
      
      - name: Markdown Lint
        uses: DavidAnson/markdownlint-cli2-action@v16
        with:
          globs: "**/*.md"
          # 使用宽松配置
          config: |
            {
              "default": true,
              "MD013": false,
              "MD033": false,
              "MD041": false,
              "MD024": false,
              "MD029": false,
              "MD030": false,
              "MD026": false,
              "MD025": false,
              "MD002": false,
              "MD012": false,
              "MD007": false,
              "MD009": false,
              "MD010": false,
              "MD011": false,
              "MD014": false,
              "MD018": false,
              "MD019": false,
              "MD020": false,
              "MD021": false,
              "MD022": false,
              "MD023": false,
              "MD027": false,
              "MD028": false,
              "MD031": false,
              "MD032": false,
              "MD034": false,
              "MD035": false,
              "MD036": false,
              "MD037": false,
              "MD038": false,
              "MD039": false,
              "MD040": false,
              "MD042": false,
              "MD043": false,
              "MD044": false,
              "MD045": false,
              "MD046": false,
              "MD047": false,
              "MD048": false,
              "MD049": false,
              "MD050": false,
              "MD051": false,
              "MD052": false,
              "MD053": false
            }
      
      - name: Success message
        if: success()
        run: |
          echo "✅ Markdown linting completed successfully!"
          echo "All markdown files passed the checks."
      
      - name: Failure message
        if: failure()
        run: |
          echo "❌ Markdown linting failed!"
          echo "Please check the logs above for specific issues."
          echo "You can also run the local check script: python scripts/check_markdown.py"
