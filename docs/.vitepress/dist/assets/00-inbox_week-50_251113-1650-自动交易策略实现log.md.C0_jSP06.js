import{_ as t,c as o,o as i,ag as s}from"./chunks/framework.CQuhCYrb.js";const g=JSON.parse('{"title":"11月12日 问题","description":"","frontmatter":{},"headers":[],"relativePath":"00-inbox/week-50/251113-1650-自动交易策略实现log.md","filePath":"00-inbox/week-50/251113-1650-自动交易策略实现log.md"}'),r={name:"00-inbox/week-50/251113-1650-自动交易策略实现log.md"};function a(n,e,p,l,h,d){return i(),o("div",null,[...e[0]||(e[0]=[s(`<p>自动交易策略流程图：</p><ol><li><p>读取MongoDB篮子股票信息；</p></li><li><p>计算每个股票的买单信息：按价格买入（1102），计算买入价格（竞价末尾位置的1.02，向下取整）；</p></li><li><p>挂单；</p></li><li><p>检查委托列表，判断是否成功挂单；</p></li><li><p>检查买入列表，判断是否成功买入；</p></li><li><p>卖出逻辑：第二天早盘9：30开始挂出卖单，按开盘价格 * 1.091卖出；下午2:55检查是否完成卖出，如果没卖出，撤单，2:57尾盘竞价开始时，挂跌停价卖出；</p></li></ol><hr><h1 id="_11月12日-问题" tabindex="-1">11月12日 问题 <a class="header-anchor" href="#_11月12日-问题" aria-label="Permalink to &quot;11月12日 问题&quot;">​</a></h1><ol><li>27:00 查询到的数据是错误的个股；</li><li>buy_price错误，</li></ol><h2 id="日志" tabindex="-1">日志 <a class="header-anchor" href="#日志" aria-label="Permalink to &quot;日志&quot;">​</a></h2><p>[2025-11-13 09:08:12][新建策略文件][SH000300][1分钟] [trade]start trading mode [2025-11-13 09:08:12][新建策略文件][SH000300][1分钟] ================================================================================ 【实盘买入策略启动】时间：2025-11-13 09:08:12 配置信息：</p><ul><li>MongoDB：192.168.1.142:27017/?authSource=stock/stock/ths_realtime_stocks</li><li>交易账号：904800028165</li><li>买入规则：竞价价×1.02（向下取整），资金均分</li><li>最大买入股票：5只 ================================================================================</li></ul><p>[2025-11-13 09:28:06][新建策略文件][SH000300][1分钟] 【MongoDB查询】时间：2025-11-13 09:28:06（重试1/18）</p><p>[2025-11-13 09:28:06][新建策略文件][SH000300][1分钟] 获取今日股票篮子：[&#39;002451.SZ&#39;, &#39;000973.SZ&#39;]（共2只）</p><p>【资金查询】账号：904800028165 ? 可用资金：10000.00元 ? 单只股票可用资金：4985.00元（含手续费预留）</p><p>【竞价价查询】股票：002451.SZ ? 竞价价查询异常：name &#39;tick_data&#39; is not defined</p><p>【竞价价查询】股票：000973.SZ ? 竞价价查询异常：name &#39;tick_data&#39; is not defined ?? 无有效买入参数，终止交易</p><h1 id="_2025-11-13-09-29-13-新建策略文件-sh000300-1分钟-0d-国投核心客户极速策略交易终端-act-python-新建策略文件-py-00030013-策略停止-2025-11-13-09-29-13-新建策略文件-sh000300-1分钟" tabindex="-1">[2025-11-13 09:29:13][新建策略文件][SH000300][1分钟] 0D:\\国投核心客户极速策略交易终端（ACT）\\python\\新建策略文件.py_00030013: 策略停止 [2025-11-13 09:29:13][新建策略文件][SH000300][1分钟] <a class="header-anchor" href="#_2025-11-13-09-29-13-新建策略文件-sh000300-1分钟-0d-国投核心客户极速策略交易终端-act-python-新建策略文件-py-00030013-策略停止-2025-11-13-09-29-13-新建策略文件-sh000300-1分钟" aria-label="Permalink to &quot;[2025-11-13 09:29:13][新建策略文件][SH000300][1分钟] 0D:\\国投核心客户极速策略交易终端（ACT）\\python\\新建策略文件.py_00030013: 策略停止
[2025-11-13 09:29:13][新建策略文件][SH000300][1分钟]&quot;">​</a></h1><h1 id="【策略停止】时间-2025-11-13-09-29-13今日交易状态-已执行买入操作建议-登录qmt交易模块-查看「委托记录」和「持仓」确认最终状态" tabindex="-1">【策略停止】时间：2025-11-13 09:29:13 今日交易状态：已执行买入操作 建议：登录QMT交易模块，查看「委托记录」和「持仓」确认最终状态 <a class="header-anchor" href="#【策略停止】时间-2025-11-13-09-29-13今日交易状态-已执行买入操作建议-登录qmt交易模块-查看「委托记录」和「持仓」确认最终状态" aria-label="Permalink to &quot;【策略停止】时间：2025-11-13 09:29:13
今日交易状态：已执行买入操作
建议：登录QMT交易模块，查看「委托记录」和「持仓」确认最终状态&quot;">​</a></h1><p>[2025-11-13 09:30:11][新建策略文件][SH000300][1分钟] [trade]start trading mode [2025-11-13 09:30:11][新建策略文件][SH000300][1分钟] ================================================================================ 【实盘买入策略启动】时间：2025-11-13 09:30:11 配置信息：</p><ul><li>MongoDB：192.168.1.142:27017/?authSource=stock/stock/ths_realtime_stocks</li><li>交易账号：904800028165</li><li>买入规则：竞价价×1.02（向下取整），资金均分</li><li>最大买入股票：5只 ================================================================================</li></ul><h1 id="_2025-11-13-09-30-25-新建策略文件-sh000300-1分钟-0d-国投核心客户极速策略交易终端-act-python-新建策略文件-py-00030024-策略停止-2025-11-13-09-30-25-新建策略文件-sh000300-1分钟" tabindex="-1">[2025-11-13 09:30:25][新建策略文件][SH000300][1分钟] 0D:\\国投核心客户极速策略交易终端（ACT）\\python\\新建策略文件.py_00030024: 策略停止 [2025-11-13 09:30:25][新建策略文件][SH000300][1分钟] <a class="header-anchor" href="#_2025-11-13-09-30-25-新建策略文件-sh000300-1分钟-0d-国投核心客户极速策略交易终端-act-python-新建策略文件-py-00030024-策略停止-2025-11-13-09-30-25-新建策略文件-sh000300-1分钟" aria-label="Permalink to &quot;[2025-11-13 09:30:25][新建策略文件][SH000300][1分钟] 0D:\\国投核心客户极速策略交易终端（ACT）\\python\\新建策略文件.py_00030024: 策略停止
[2025-11-13 09:30:25][新建策略文件][SH000300][1分钟]&quot;">​</a></h1><h1 id="【策略停止】时间-2025-11-13-09-30-25今日交易状态-未执行交易建议-登录qmt交易模块-查看「委托记录」和「持仓」确认最终状态" tabindex="-1">【策略停止】时间：2025-11-13 09:30:25 今日交易状态：未执行交易 建议：登录QMT交易模块，查看「委托记录」和「持仓」确认最终状态 <a class="header-anchor" href="#【策略停止】时间-2025-11-13-09-30-25今日交易状态-未执行交易建议-登录qmt交易模块-查看「委托记录」和「持仓」确认最终状态" aria-label="Permalink to &quot;【策略停止】时间：2025-11-13 09:30:25
今日交易状态：未执行交易
建议：登录QMT交易模块，查看「委托记录」和「持仓」确认最终状态&quot;">​</a></h1><p>[2025-11-13 09:31:01][新建策略文件][SH000300][1分钟] [trade]start trading mode [2025-11-13 09:31:01][新建策略文件][SH000300][1分钟] ================================================================================ 【实盘买入策略启动】时间：2025-11-13 09:31:01 配置信息：</p><ul><li>MongoDB：192.168.1.142:27017/?authSource=stock/stock/ths_realtime_stocks</li><li>交易账号：904800028165</li><li>买入规则：竞价价×1.02（向下取整），资金均分</li><li>最大买入股票：5只 ================================================================================</li></ul><p>【MongoDB查询】时间：2025-11-13 09:31:01（重试1/18）</p><p>[2025-11-13 09:31:01][新建策略文件][SH000300][1分钟] 获取今日股票篮子：[&#39;300497.SZ&#39;]（共1只）</p><p>【资金查询】账号：904800028165 ? 可用资金：10000.00元 ? 单只股票可用资金：9970.00元（含手续费预留）</p><p>【竞价价查询】股票：300497.SZ 集合竞价数据-300497.SZ：开盘价=17.01, 最新价=17.5 成交量=202298, 成交额=350095000.0 ? 集合竞价价格：17.01元 ? 买入参数：300497.SZ | 价格17.35元 | 500手（50000股）</p><p>【挂单操作】股票：300497.SZ market_code: 2 float(lots): 500.0 ?? 挂单请求发送成功：300497.SZ | 价格17.35元 | 500手</p><p>[2025-11-13 09:31:04][新建策略文件][SH000300][1分钟] 【委托状态检查】股票：300497.SZ ?? 未找到目标委托，当前所有委托： ? 委托状态查询异常：&#39;COrderDetail&#39; object has no attribute &#39;m_strOrderCode&#39;</p><p>[2025-11-13 09:31:05][新建策略文件][SH000300][1分钟] ? 所有股票买入操作已完成</p><p>##################################################################################################################</p><hr><h1 id="_11月13日" tabindex="-1">11月13日 <a class="header-anchor" href="#_11月13日" aria-label="Permalink to &quot;11月13日&quot;">​</a></h1><h2 id="问题" tabindex="-1">问题： <a class="header-anchor" href="#问题" aria-label="Permalink to &quot;问题：&quot;">​</a></h2><ol><li>买入：千尾；</li><li>卖出：千竞 = 涨停价格 * 0.97，向下取整； 千尾 = 涨停价格 * 0.91，向上取整； 没涨停，尾盘直接卖出；</li><li>买入的有效检查 = 查委托 + 查持仓；</li><li>卖出逻辑：第二天早盘9：30开始挂出卖单，按涨停价格 * 0.91卖出；下午2:55检查是否完成卖出，如果没卖出，撤单，2:57尾盘竞价开始时，挂跌停价卖出；</li></ol><h2 id="日志-1" tabindex="-1">日志： <a class="header-anchor" href="#日志-1" aria-label="Permalink to &quot;日志：&quot;">​</a></h2><p>[2025-11-14 09:17:57][新建策略文件][SH000300][1分钟] [trade]start trading mode [2025-11-14 09:17:57][新建策略文件][SH000300][1分钟] ================================================================================ 【实盘买入策略启动】时间：2025-11-14 09:17:57 配置信息：</p><ul><li>MongoDB：192.168.1.142:27017/?authSource=stock/stock/ths_realtime_stocks</li><li>交易账号：904800028165</li><li>买入规则：竞价价×1.02（向下取整），资金均分</li><li>卖出规则：次日9:30涨停价×0.91挂单，14:55未卖撤单，14:57跌停价卖出 ================================================================================</li></ul><p>[2025-11-14 09:28:04][新建策略文件][SH000300][1分钟] 【MongoDB查询】时间：2025-11-14 09:28:04（重试1/18）</p><p>[2025-11-14 09:28:04][新建策略文件][SH000300][1分钟] 获取今日股票篮子：[&#39;000572.SZ&#39;, &#39;000688.SZ&#39;]（共2只）</p><p>【资金查询】账号：904800028165 可用资金：9999.00元 单只股票可用资金：4984.50元（含手续费预留）</p><p>【竞价价格查询】股票：000572.SZ 集合竞价数据-000572.SZ：开盘价=10.5, 最新价=10.5 成交量=146411, 成交额=153731600.0 集合竞价价格：10.50元 买入参数：000572.SZ | 价格10.71元 | 400手（40000股）</p><p>【竞价价格查询】股票：000688.SZ 集合竞价数据-000688.SZ：开盘价=25.0, 最新价=25.0 成交量=17923, 成交额=44808400.0 集合竞价价格：25.00元 买入参数：000688.SZ | 价格25.50元 | 100手（10000股）</p><p>【挂单操作】股票：000572.SZ market_code: 2 float(lots): 400.0 挂单请求发送成功：000572.SZ | 价格10.71元 | 400手</p><p>[2025-11-14 09:28:07][新建策略文件][SH000300][1分钟] 【委托状态检查】股票：000572.SZ 【获取最新委托ID】账号：904800028165 成功获取最新委托ID：MM853127 委托校验通过 | 委托ID=MM853127 | 状态=已报（等待成交） | 股票=000572 | 价格=10.71元 | 手数=400</p><p>【持仓状态检查】股票：000572.SZ 未查询到持仓记录</p><p>[2025-11-14 09:28:08][新建策略文件][SH000300][1分钟] 【挂单操作】股票：000688.SZ market_code: 2 float(lots): 100.0 挂单请求发送成功：000688.SZ | 价格25.50元 | 100手</p><p>[2025-11-14 09:28:11][新建策略文件][SH000300][1分钟] 【委托状态检查】股票：000688.SZ 【获取最新委托ID】账号：904800028165 成功获取最新委托ID：MM853131 委托校验通过 | 委托ID=MM853131 | 状态=已报（等待成交） | 股票=000688 | 价格=25.50元 | 手数=100</p><p>【持仓状态检查】股票：000688.SZ 未查询到持仓记录</p><p>[2025-11-14 09:28:12][新建策略文件][SH000300][1分钟] 所有股票买入操作已完成</p><hr><h1 id="_11月17日" tabindex="-1">11月17日 <a class="header-anchor" href="#_11月17日" aria-label="Permalink to &quot;11月17日&quot;">​</a></h1><h2 id="日志-2" tabindex="-1">日志： <a class="header-anchor" href="#日志-2" aria-label="Permalink to &quot;日志：&quot;">​</a></h2><p>[2025-11-17 09:11:03][新建策略文件][SH000300][1分钟] [trade]start trading mode [2025-11-17 09:11:03][新建策略文件][SH000300][1分钟] ================================================================================ 【实盘买入策略启动】时间：2025-11-17 09:11:03 配置信息：</p><ul><li>MongoDB：192.168.1.142:27017/?authSource=stock/stock/ths_realtime_stocks</li><li>交易账号：904800028165</li><li>买入规则：竞价价×1.02（向下取整），资金均分</li><li>卖出规则：次日9:30涨停价×0.91挂单，14:55未卖撤单，14:57跌停价卖出 ================================================================================</li></ul><p>[2025-11-17 09:28:00][新建策略文件][SH000300][1分钟] 【MongoDB查询】时间：2025-11-17 09:28:00（重试1/18）</p><p>[2025-11-17 09:28:00][新建策略文件][SH000300][1分钟] 警告：未找到今日（2025-11-17）有效股票篮子，10秒后重试</p><p>[2025-11-17 09:28:10][新建策略文件][SH000300][1分钟] 【MongoDB查询】时间：2025-11-17 09:28:10（重试2/18）</p><p>[2025-11-17 09:28:10][新建策略文件][SH000300][1分钟] 警告：未找到今日（2025-11-17）有效股票篮子，10秒后重试</p><p>[2025-11-17 09:28:20][新建策略文件][SH000300][1分钟] 【MongoDB查询】时间：2025-11-17 09:28:20（重试3/18）</p><p>[2025-11-17 09:28:20][新建策略文件][SH000300][1分钟] 警告：未找到今日（2025-11-17）有效股票篮子，10秒后重试</p><p>[2025-11-17 09:28:30][新建策略文件][SH000300][1分钟] 【MongoDB查询】时间：2025-11-17 09:28:30（重试4/18）</p><p>[2025-11-17 09:28:30][新建策略文件][SH000300][1分钟] 获取今日股票篮子：[&#39;603931.SH&#39;]（共1只）</p><p>【资金查询】账号：904800028165 可用资金：13209.35元 单只股票可用资金：13169.72元（含手续费预留）</p><p>【竞价价格查询】股票：603931.SH 集合竞价数据-603931.SH：开盘价=32.0, 最新价=32.0 成交量=4901, 成交额=15683200.0 集合竞价价格：32.00元 买入参数：603931.SH | 价格32.64元 | 400手（40000股）</p><p>【挂单操作】股票：603931.SH market_code: 1 float(lots): 400.0 挂单请求发送成功：603931.SH | 价格32.64元 | 400手</p><p>[2025-11-17 09:28:33][新建策略文件][SH000300][1分钟] 【委托状态检查】股票：603931.SH 【获取最新委托ID】账号：904800028165 成功获取最新委托ID：MM567559 委托校验通过 | 委托ID=MM567559 | 状态=已报（等待成交） | 股票=603931 | 价格=32.64元 | 手数=400</p><p>【持仓状态检查】股票：603931.SH 未找到目标持仓</p><p>[2025-11-17 09:28:34][新建策略文件][SH000300][1分钟] 所有股票买入操作已完成</p><h2 id="问题-1" tabindex="-1">问题： <a class="header-anchor" href="#问题-1" aria-label="Permalink to &quot;问题：&quot;">​</a></h2><ol><li>分成两个账号轮流交易，每次记录两个分仓的信息；</li><li>卖出价格是开盘价的1.091，不是涨停价的0.91</li><li>持仓信息不能用代码中的函数记录，因为每天代码会被关闭，只有早上快开盘的时候才开始运行，所以持仓信息需要直接查询</li><li>mongoDB股票信息刷新错误，最后一次更新在update_time 2025-11-17T09:32:32.473+00:00</li></ol><hr><h1 id="_11月18日" tabindex="-1">11月18日 <a class="header-anchor" href="#_11月18日" aria-label="Permalink to &quot;11月18日&quot;">​</a></h1><h2 id="日志-3" tabindex="-1">日志： <a class="header-anchor" href="#日志-3" aria-label="Permalink to &quot;日志：&quot;">​</a></h2><p>[2025-11-18 09:21:23][新建策略文件][SH000300][1分钟] [trade]start trading mode [2025-11-18 09:21:23][新建策略文件][SH000300][1分钟] ================================================================================ 【实盘买入策略启动】时间：2025-11-18 09:21:23 配置信息：</p><ul><li>MongoDB：192.168.1.142:27017/?authSource=stock/stock/ths_realtime_stocks</li><li>交易账号：904800028165</li><li>买入规则：竞价价×1.02（向下取整），资金均分</li><li>卖出规则：次日9:30开盘价×1.091挂单，14:55未卖撤单，14:57跌停价卖出 ================================================================================</li></ul><p>[2025-11-18 09:28:01][新建策略文件][SH000300][1分钟] 【MongoDB查询】时间：2025-11-18 09:28:01（重试1/18）</p><p>[2025-11-18 09:28:01][新建策略文件][SH000300][1分钟] 获取今日股票篮子：[&#39;600829.SH&#39;, &#39;000636.SZ&#39;]（共2只）</p><p>【资金查询】账号：904800028165 可用资金：7417.83元 单只股票可用资金：3697.79元（含手续费预留）</p><p>【竞价价格查询】股票：600829.SH 集合竞价数据-600829.SH：开盘价=16.7, 最新价=16.7 成交量=51102, 成交额=85340500.0 集合竞价价格：16.70元 买入参数：600829.SH | 价格17.03元 | 200手（20000股）</p><p>【竞价价格查询】股票：000636.SZ 集合竞价数据-000636.SZ：开盘价=17.830000000000002, 最新价=17.830000000000002 成交量=24239, 成交额=43218100.0 集合竞价价格：17.83元 买入参数：000636.SZ | 价格18.18元 | 200手（20000股）</p><p>【挂单操作】股票：600829.SH market_code: 1 float(lots): 200.0 挂单请求发送成功：600829.SH | 价格17.03元 | 200手</p><p>[2025-11-18 09:28:04][新建策略文件][SH000300][1分钟] 【委托状态检查】股票：600829.SH 【获取最新委托ID】账号：904800028165 成功获取最新委托ID：MM575061 委托校验通过 | 委托ID=MM575061 | 状态=已报（等待成交） | 股票=600829 | 价格=17.03元 | 手数=200</p><p>【持仓状态检查】股票：600829.SH 未找到目标持仓</p><p>[2025-11-18 09:28:05][新建策略文件][SH000300][1分钟] 【挂单操作】股票：000636.SZ market_code: 2 float(lots): 200.0 挂单请求发送成功：000636.SZ | 价格18.18元 | 200手</p><p>[2025-11-18 09:28:08][新建策略文件][SH000300][1分钟] 【委托状态检查】股票：000636.SZ 【获取最新委托ID】账号：904800028165 成功获取最新委托ID：MM872166 委托校验通过 | 委托ID=MM872166 | 状态=已报（等待成交） | 股票=000636 | 价格=18.18元 | 手数=200</p><p>【持仓状态检查】股票：000636.SZ 未找到目标持仓</p><p>[2025-11-18 09:28:09][新建策略文件][SH000300][1分钟] 所有股票买入操作已完成</p><p>[2025-11-18 09:30:00][新建策略文件][SH000300][1分钟] 【早盘卖出】时间窗口触发（09:30:00）</p><p>【查询当前持仓】账号：904800028165 当前持仓：[&#39;603931.SH&#39;]（共1只）</p><p>【卖出挂单】股票：603931.SH | 价格=33.16元 | 手数=4 【获取最新委托ID】账号：904800028165 成功获取最新委托ID：MM872166 卖出挂单成功 | 委托ID=MM872166 【早盘卖出】批量挂单完成，等待成交</p><p>[2025-11-18 09:31:00][新建策略文件][SH000300][1分钟] 【早盘成交监控】时间：09:31:00（每30秒检查一次）</p><p>【查询当前持仓】账号：904800028165 当前持仓：[&#39;600829.SH&#39;, &#39;603931.SH&#39;]（共2只）</p><h2 id="问题-2" tabindex="-1">问题： <a class="header-anchor" href="#问题-2" aria-label="Permalink to &quot;问题：&quot;">​</a></h2><ol><li><p>股池读取错误，改为9:28再读取；</p></li><li><p>卖出挂单失败，需要debug，当前日志中显示只卖出了2股，可能是代码计算的手数当成了卖出的股数，改为以股数卖出。</p></li><li><p>check_position_status 函数debug功能；</p></li><li><p>第二天卖出的时间改为9:26挂卖出单；</p></li><li><p>去除全天监控是否卖出的逻辑，只在尾盘竞价前执行检查卖出情况和撤单逻辑；</p></li><li><p>次日判断（只挂前一天买入的票）；</p></li><li><p>撤单功能：14:55 直接查询全部委托列表，按「当前持仓代码 + 状态=未成/部成」来撤单</p></li></ol><hr><h1 id="_11月19日" tabindex="-1">11月19日 <a class="header-anchor" href="#_11月19日" aria-label="Permalink to &quot;11月19日&quot;">​</a></h1><h2 id="日志-4" tabindex="-1">日志： <a class="header-anchor" href="#日志-4" aria-label="Permalink to &quot;日志：&quot;">​</a></h2><p>[2025-11-19 09:40:37][新建策略文件][SH000300][1分钟] 0D:\\国投核心客户极速策略交易终端（ACT）\\python\\新建策略文件.py_000300129: 策略停止 [2025-11-19 09:40:38][新建策略文件][SH000300][1分钟] [trade]start trading mode [2025-11-19 09:40:38][新建策略文件][SH000300][1分钟] ================================================================================ 【实盘买入策略启动】时间：2025-11-19 09:40:38 配置信息：</p><ul><li>MongoDB：192.168.1.142:27017/?authSource=stock/stock/ths_realtime_stocks</li><li>交易账号：904800028165</li><li>买入规则：竞价价×1.02（向下取整），资金均分</li><li>卖出规则：次日9:30开盘价×1.091挂单，14:55未卖撤单，14:57跌停价卖出 ================================================================================</li></ul><h1 id="_2025-11-19-09-40-38-新建策略文件-sh000300-1分钟" tabindex="-1">[2025-11-19 09:40:38][新建策略文件][SH000300][1分钟] <a class="header-anchor" href="#_2025-11-19-09-40-38-新建策略文件-sh000300-1分钟" aria-label="Permalink to &quot;[2025-11-19 09:40:38][新建策略文件][SH000300][1分钟]&quot;">​</a></h1><h1 id="早盘卖出流程启动-时间-09-40-38" tabindex="-1">早盘卖出流程启动 时间：09:40:38 <a class="header-anchor" href="#早盘卖出流程启动-时间-09-40-38" aria-label="Permalink to &quot;早盘卖出流程启动  时间：09:40:38&quot;">​</a></h1><p>【查询当前持仓】账号：904800028165 当前持仓：[&#39;600829.SH&#39;, &#39;002083.SZ&#39;]（共2只） 【早盘卖出】600829.SH 基准价=17.72 * 1.091 -&gt; 卖出价=19.33元</p><p>【卖出挂单】股票：600829.SH | 价格=19.33元 | 股数=200 【获取最新委托ID】账号：904800028165 成功获取最新委托ID：MM583426 卖出挂单成功 | 委托ID=MM583426 【早盘卖出】002083.SZ 基准价=12.46 * 1.091 -&gt; 卖出价=13.59元</p><p>【卖出挂单】股票：002083.SZ | 价格=13.59元 | 股数=600 【获取最新委托ID】账号：904800028165</p><p>[2025-11-19 09:40:38][新建策略文件][SH000300][1分钟] 成功获取最新委托ID：MM583426 卖出挂单成功 | 委托ID=MM583426 【早盘卖出】批量挂单结束</p><h2 id="问题-3" tabindex="-1">问题： <a class="header-anchor" href="#问题-3" aria-label="Permalink to &quot;问题：&quot;">​</a></h2><ol><li>卖出价格应该基于last close计算涨停价格，而不是开盘价。（已修复）</li><li>9:28 买入时，MongoDB数据依然错误，直到29:xx，才买入新股；</li><li>*卖出撤单失败，测试撤单</li></ol><p>order 字段：[&#39;-1&#39;, &#39;0&#39;, &#39;1&#39;, &#39;101&#39;, &#39;107&#39;, &#39;108&#39;, &#39;109&#39;, &#39;110&#39;, &#39;111&#39;, &#39;112&#39;, &#39;113&#39;, &#39;114&#39;, &#39;2&#39;, &#39;255&#39;, &#39;32&#39;, &#39;48&#39;, &#39;49&#39;, &#39;50&#39;, &#39;51&#39;, &#39;52&#39;, &#39;53&#39;, &#39;54&#39;, &#39;55&#39;, &#39;56&#39;, &#39;57&#39;, &#39;58&#39;, &#39;59&#39;, &#39;60&#39;, &#39;61&#39;, &#39;66&#39;, &#39;67&#39;, &#39;68&#39;, &#39;69&#39;, &#39;70&#39;, &#39;71&#39;, &#39;72&#39;, &#39;73&#39;, &#39;75&#39;, &#39;77&#39;, &#39;78&#39;, &#39;79&#39;, &#39;80&#39;, &#39;81&#39;, &#39;83&#39;, &#39;84&#39;, &#39;85&#39;, &#39;86&#39;, &#39;87&#39;, &#39;88&#39;, &#39;89&#39;, &#39;90&#39;, &#39;91&#39;, &#39;92&#39;, &#39;93&#39;, &#39;94&#39;, &#39;EBrokerPriceType&#39;, &#39;ECoveredFlag&#39;, &#39;EEntrustBS&#39;, &#39;EEntrustStatus&#39;, &#39;EEntrustSubmitStatus&#39;, &#39;EEntrustTypes&#39;, &#39;EFutureTradeType&#39;, &#39;EHedge_Flag_Type&#39;, &#39;EOffset_Flag_Type&#39;, &#39;ESideFlag&#39;, &#39;EXTCompactBrushSource&#39;, &#39;EXTCompactStatus&#39;, &#39;EXTCompactType&#39;, &#39;EXTSloTypeQueryMode&#39;, &#39;EXTSubjectsStatus&#39;, &#39;<strong>class</strong>&#39;, &#39;<strong>delattr</strong>&#39;, &#39;<strong>dict</strong>&#39;, &#39;<strong>dir</strong>&#39;, &#39;<strong>doc</strong>&#39;, &#39;<strong>eq</strong>&#39;, &#39;<strong>format</strong>&#39;, &#39;<strong>ge</strong>&#39;, &#39;<strong>getattribute</strong>&#39;, &#39;<strong>gt</strong>&#39;, &#39;<strong>hash</strong>&#39;, &#39;<strong>init</strong>&#39;, &#39;<strong>init_subclass</strong>&#39;, &#39;<strong>instance_size</strong>&#39;, &#39;<strong>le</strong>&#39;, &#39;<strong>lt</strong>&#39;, &#39;<strong>ne</strong>&#39;, &#39;<strong>new</strong>&#39;, &#39;<strong>reduce</strong>&#39;, &#39;<strong>reduce_ex</strong>&#39;, &#39;<strong>repr</strong>&#39;, &#39;<strong>setattr</strong>&#39;, &#39;<strong>sizeof</strong>&#39;, &#39;<strong>str</strong>&#39;, &#39;<strong>subclasshook</strong>&#39;, &#39;<strong>weakref</strong>&#39;, &#39;j&#39;, &#39;m_bEnable&#39;, &#39;m_dCancelAmount&#39;, &#39;m_dFrozenCommission&#39;, &#39;m_dFrozenMargin&#39;, &#39;m_dLimitPrice&#39;, &#39;m_dOrderPriceRMB&#39;, &#39;m_dReferenceRate&#39;, &#39;m_dShortOccupedMargin&#39;, &#39;m_dTradeAmount&#39;, &#39;m_dTradeAmountRMB&#39;, &#39;m_dTradedPrice&#39;, &#39;m_eCashgroupProp&#39;, &#39;m_eCoveredFlag&#39;, &#39;m_eEntrustType&#39;, &#39;m_nDirection&#39;, &#39;m_nErrorID&#39;, &#39;m_nFrontID&#39;, &#39;m_nGroupId&#39;, &#39;m_nHedgeFlag&#39;, &#39;m_nOffsetFlag&#39;, &#39;m_nOpType&#39;, &#39;m_nOrderPriceType&#39;, &#39;m_nOrderStatus&#39;, &#39;m_nOrderStrategyType&#39;, &#39;m_nOrderSubmitStatus&#39;, &#39;m_nRef&#39;, &#39;m_nSessionID&#39;, &#39;m_nStrategyID&#39;, &#39;m_nTaskId&#39;, &#39;m_nVolumeTotal&#39;, &#39;m_nVolumeTotalOriginal&#39;, &#39;m_nVolumeTraded&#39;, &#39;m_strAccountID&#39;, &#39;m_strAccountKey&#39;, &#39;m_strAccountName&#39;, &#39;m_strAccountRemark&#39;, &#39;m_strBrokerName&#39;, &#39;m_strCancelInfo&#39;, &#39;m_strCompactNo&#39;, &#39;m_strErrorMsg&#39;, &#39;m_strExchangeID&#39;, &#39;m_strExchangeName&#39;, &#39;m_strInsertDate&#39;, &#39;m_strInsertTime&#39;, &#39;m_strInstrumentID&#39;, &#39;m_strInstrumentName&#39;, &#39;m_strLocalInfo&#39;, &#39;m_strOptName&#39;, &#39;m_strOption&#39;, &#39;m_strOrderParam&#39;, &#39;m_strOrderRef&#39;, &#39;m_strOrderStrategyType&#39;, &#39;m_strOrderSysID&#39;, &#39;m_strProductID&#39;, &#39;m_strProductName&#39;, &#39;m_strRemark&#39;, &#39;m_strSource&#39;, &#39;m_strUnderCode&#39;, &#39;m_strXTTrade&#39;, &#39;m_xtTag&#39;, &#39;w&#39;, &#39;x&#39;, &#39;y&#39;, &#39;z&#39;]</p><p>order.m_nDirection:48 order.m_strOptName:限价卖出 order.m_nOrderStatus:54 order.m_strOrderSysID:MM582811</p><hr><h1 id="_11月20日" tabindex="-1">11月20日 <a class="header-anchor" href="#_11月20日" aria-label="Permalink to &quot;11月20日&quot;">​</a></h1><h2 id="日志-5" tabindex="-1">日志： <a class="header-anchor" href="#日志-5" aria-label="Permalink to &quot;日志：&quot;">​</a></h2><p>[2025-11-20 09:06:00][新建策略文件][SH000300][1分钟] [trade]start trading mode [2025-11-20 09:06:00][新建策略文件][SH000300][1分钟] ================================================================================ 【实盘买入策略启动】时间：2025-11-20 09:06:00 配置信息：</p><ul><li>MongoDB：192.168.1.142:27017/?authSource=stock/stock/ths_realtime_stocks</li><li>交易账号：904800028165</li><li>买入规则：竞价价×1.02（向下取整），资金均分</li><li>卖出规则：次日9:30开盘价×1.091挂单，14:55未卖撤单，14:57跌停价卖出 ================================================================================</li></ul><h1 id="_2025-11-20-09-28-01-新建策略文件-sh000300-1分钟" tabindex="-1">[2025-11-20 09:28:01][新建策略文件][SH000300][1分钟] <a class="header-anchor" href="#_2025-11-20-09-28-01-新建策略文件-sh000300-1分钟" aria-label="Permalink to &quot;[2025-11-20 09:28:01][新建策略文件][SH000300][1分钟]&quot;">​</a></h1><h1 id="竞价买入流程启动-时间-09-28-01" tabindex="-1">竞价买入流程启动 时间：09:28:01 <a class="header-anchor" href="#竞价买入流程启动-时间-09-28-01" aria-label="Permalink to &quot;竞价买入流程启动  时间：09:28:01&quot;">​</a></h1><p>【MongoDB查询】时间：2025-11-20 09:28:01（重试1/18）</p><p>[2025-11-20 09:28:01][新建策略文件][SH000300][1分钟] 获取今日股票篮子：[&#39;001216.SZ&#39;, &#39;000632.SZ&#39;, &#39;002474.SZ&#39;]（共3只）</p><p>【资金查询】账号：904800028165 可用资金：9086.65元 单只股票可用资金：3019.80元（含手续费预留）</p><p>【竞价价格查询】股票：001216.SZ 集合竞价数据-001216.SZ：开盘价=22.150000000000002, 最新价=22.150000000000002 成交量=48574, 成交额=107591400.0 集合竞价价格：22.15元 买入参数：001216.SZ | 价格22.59元 | 100股</p><p>【竞价价格查询】股票：000632.SZ 集合竞价数据-000632.SZ：开盘价=6.8, 最新价=6.8 成交量=551931, 成交额=375313200.0 集合竞价价格：6.80元 买入参数：000632.SZ | 价格6.93元 | 400股</p><p>【竞价价格查询】股票：002474.SZ 集合竞价数据-002474.SZ：开盘价=11.1, 最新价=11.1 成交量=96660, 成交额=107292600.0 集合竞价价格：11.10元 买入参数：002474.SZ | 价格11.32元 | 200股</p><p>[买入流程] 001216.SZ | 目标价=22.59 | lots=100</p><p>【挂单操作】股票：001216.SZ 挂单请求发送成功：001216.SZ | 价格22.59元 | 100手</p><p>[2025-11-20 09:28:04][新建策略文件][SH000300][1分钟] 【委托状态检查】股票：001216.SZ 【获取最新委托ID】账号：904800028165 成功获取最新委托ID：MM889936 委托校验通过 | 委托ID=MM889936 | 状态=已报（等待成交） | 股票=001216 | 价格=22.59元 | 手数=100</p><p>【持仓状态检查】股票：001216.SZ 未找到目标持仓</p><p>[2025-11-20 09:28:05][新建策略文件][SH000300][1分钟] [买入流程] 000632.SZ | 目标价=6.93 | lots=400</p><p>【挂单操作】股票：000632.SZ 挂单请求发送成功：000632.SZ | 价格6.93元 | 400手</p><p>[2025-11-20 09:28:08][新建策略文件][SH000300][1分钟] 【委托状态检查】股票：000632.SZ 【获取最新委托ID】账号：904800028165 成功获取最新委托ID：MM889938 委托校验通过 | 委托ID=MM889938 | 状态=已报（等待成交） | 股票=000632 | 价格=6.93元 | 手数=400</p><p>【持仓状态检查】股票：000632.SZ 未找到目标持仓</p><p>[2025-11-20 09:28:09][新建策略文件][SH000300][1分钟] [买入流程] 002474.SZ | 目标价=11.32 | lots=200</p><p>【挂单操作】股票：002474.SZ 挂单请求发送成功：002474.SZ | 价格11.32元 | 200手</p><p>[2025-11-20 09:28:12][新建策略文件][SH000300][1分钟] 【委托状态检查】股票：002474.SZ 【获取最新委托ID】账号：904800028165 成功获取最新委托ID：MM889942 委托校验通过 | 委托ID=MM889942 | 状态=已报（等待成交） | 股票=002474 | 价格=11.32元 | 手数=200</p><p>【持仓状态检查】股票：002474.SZ 未找到目标持仓</p><p>[2025-11-20 09:28:13][新建策略文件][SH000300][1分钟] 【竞价买入】所有股票买入流程结束</p><hr><h1 id="_11月28日" tabindex="-1">11月28日 <a class="header-anchor" href="#_11月28日" aria-label="Permalink to &quot;11月28日&quot;">​</a></h1><h2 id="日志-6" tabindex="-1">日志 <a class="header-anchor" href="#日志-6" aria-label="Permalink to &quot;日志&quot;">​</a></h2><p>[2025-11-28 09:24:37][新建策略文件][SH000300][1分钟] [trade]start trading mode [2025-11-28 09:24:37][新建策略文件][SH000300][1分钟] ================================================================================ 【实盘买入策略启动】时间：2025-11-28 09:24:37 配置信息：</p><ul><li>MongoDB：192.168.1.142:27017/?authSource=stock/stock/ths_realtime_stocks</li><li>交易账号：904800028165</li><li>买入规则：竞价价×1.02（向下取整），资金均分</li><li>卖出规则：次日9:30开盘价×1.091挂单，14:55未卖撤单，14:57跌停价卖出 ================================================================================</li></ul><p>[2025-11-28 09:25:00][新建策略文件][SH000300][1分钟] [TIMER] timer_morning_sell fired</p><h1 id="早盘卖出流程启动-时间-09-25-00" tabindex="-1">======================================== 早盘卖出流程启动 时间：09:25:00 <a class="header-anchor" href="#早盘卖出流程启动-时间-09-25-00" aria-label="Permalink to &quot;========================================
早盘卖出流程启动  时间：09:25:00&quot;">​</a></h1><p>【查询当前持仓】账号：904800028165 当前持仓：[&#39;000859.SZ&#39;, &#39;301638.SZ&#39;]（共2只） 【早盘卖出】000859.SZ 基准价=8.47 * 1.091 -&gt; 卖出价=9.24元</p><p>【卖出挂单】股票：000859.SZ | 价格=9.24元 | 股数=900 【获取最新委托ID】账号：904800028165 未获取到最新委托ID（返回值：-1） 卖出挂单成功，但未获取到委托ID 【早盘卖出】301638.SZ 基准价=25.75 * 1.191 -&gt; 卖出价=30.66元</p><p>【卖出挂单】股票：301638.SZ | 价格=30.66元 | 股数=300 【获取最新委托ID】账号：904800028165 未获取到最新委托ID（返回值：-1） 卖出挂单成功，但未获取到委托ID 【早盘卖出】批量挂单结束</p><p>[2025-11-28 09:27:30][新建策略文件][SH000300][1分钟] [TIMER] timer_auction_buy fired</p><h1 id="竞价买入流程启动-时间-09-27-30" tabindex="-1">======================================== 竞价买入流程启动 时间：09:27:30 <a class="header-anchor" href="#竞价买入流程启动-时间-09-27-30" aria-label="Permalink to &quot;========================================
竞价买入流程启动  时间：09:27:30&quot;">​</a></h1><p>【MongoDB查询】时间：2025-11-28 09:27:30（重试1/18）</p><p>[2025-11-28 09:27:35][新建策略文件][SH000300][1分钟] 获取股票篮子失败：No servers found yet, Timeout: 5.0s, Topology Description: &lt;TopologyDescription id: 6928fa821c85d8bff8680528, topology_type: Single, servers: [&lt;ServerDescription (&#39;192.168.1.142&#39;, 27017) server_type: Unknown, rtt: None&gt;]&gt;，10秒后重试</p><p>[2025-11-28 09:27:45][新建策略文件][SH000300][1分钟] 【MongoDB查询】时间：2025-11-28 09:27:45（重试2/18）</p><p>[2025-11-28 09:27:50][新建策略文件][SH000300][1分钟] 获取股票篮子失败：No servers found yet, Timeout: 5.0s, Topology Description: &lt;TopologyDescription id: 6928fa911c85d8bff8680529, topology_type: Single, servers: [&lt;ServerDescription (&#39;192.168.1.142&#39;, 27017) server_type: Unknown, rtt: None&gt;]&gt;，10秒后重试</p><p>[2025-11-28 09:28:00][新建策略文件][SH000300][1分钟] 【MongoDB查询】时间：2025-11-28 09:28:00（重试3/18）</p><p>[2025-11-28 09:28:05][新建策略文件][SH000300][1分钟] 获取股票篮子失败：No servers found yet, Timeout: 5.0s, Topology Description: &lt;TopologyDescription id: 6928faa01c85d8bff868052a, topology_type: Single, servers: [&lt;ServerDescription (&#39;192.168.1.142&#39;, 27017) server_type: Unknown, rtt: None&gt;]&gt;，10秒后重试</p><p>[2025-11-28 09:28:15][新建策略文件][SH000300][1分钟] 【MongoDB查询】时间：2025-11-28 09:28:15（重试4/18）</p><p>[2025-11-28 09:28:21][新建策略文件][SH000300][1分钟] 获取股票篮子失败：No servers found yet, Timeout: 5.0s, Topology Description: &lt;TopologyDescription id: 6928faaf1c85d8bff868052b, topology_type: Single, servers: [&lt;ServerDescription (&#39;192.168.1.142&#39;, 27017) server_type: Unknown, rtt: None&gt;]&gt;，10秒后重试</p><p>[2025-11-28 09:28:31][新建策略文件][SH000300][1分钟] 【MongoDB查询】时间：2025-11-28 09:28:31（重试5/18）</p><p>[2025-11-28 09:28:36][新建策略文件][SH000300][1分钟] 获取股票篮子失败：No servers found yet, Timeout: 5.0s, Topology Description: &lt;TopologyDescription id: 6928fabf1c85d8bff868052c, topology_type: Single, servers: [&lt;ServerDescription (&#39;192.168.1.142&#39;, 27017) server_type: Unknown, rtt: None&gt;]&gt;，10秒后重试</p><p>[2025-11-28 09:28:46][新建策略文件][SH000300][1分钟] 【MongoDB查询】时间：2025-11-28 09:28:46（重试6/18）</p><p>[2025-11-28 09:28:51][新建策略文件][SH000300][1分钟] 获取股票篮子失败：No servers found yet, Timeout: 5.0s, Topology Description: &lt;TopologyDescription id: 6928face1c85d8bff868052d, topology_type: Single, servers: [&lt;ServerDescription (&#39;192.168.1.142&#39;, 27017) server_type: Unknown, rtt: None&gt;]&gt;，10秒后重试</p><p>[2025-11-28 09:29:01][新建策略文件][SH000300][1分钟] 【MongoDB查询】时间：2025-11-28 09:29:01（重试7/18）</p><p>[2025-11-28 09:29:06][新建策略文件][SH000300][1分钟] 获取股票篮子失败：No servers found yet, Timeout: 5.0s, Topology Description: &lt;TopologyDescription id: 6928fadd1c85d8bff868052e, topology_type: Single, servers: [&lt;ServerDescription (&#39;192.168.1.142&#39;, 27017) server_type: Unknown, rtt: None&gt;]&gt;，10秒后重试</p><p>[2025-11-28 09:29:16][新建策略文件][SH000300][1分钟] 【MongoDB查询】时间：2025-11-28 09:29:16（重试8/18）</p><p>[2025-11-28 09:29:22][新建策略文件][SH000300][1分钟] 获取股票篮子失败：No servers found yet, Timeout: 5.0s, Topology Description: &lt;TopologyDescription id: 6928faec1c85d8bff868052f, topology_type: Single, servers: [&lt;ServerDescription (&#39;192.168.1.142&#39;, 27017) server_type: Unknown, rtt: None&gt;]&gt;，10秒后重试</p><p>[2025-11-28 09:29:32][新建策略文件][SH000300][1分钟] 【MongoDB查询】时间：2025-11-28 09:29:32（重试9/18）</p><p>[2025-11-28 09:29:37][新建策略文件][SH000300][1分钟] 获取股票篮子失败：No servers found yet, Timeout: 5.0s, Topology Description: &lt;TopologyDescription id: 6928fafc1c85d8bff8680530, topology_type: Single, servers: [&lt;ServerDescription (&#39;192.168.1.142&#39;, 27017) server_type: Unknown, rtt: None&gt;]&gt;，10秒后重试</p><p>[2025-11-28 09:29:47][新建策略文件][SH000300][1分钟] 【MongoDB查询】时间：2025-11-28 09:29:47（重试10/18）</p><p>[2025-11-28 09:29:52][新建策略文件][SH000300][1分钟] 获取股票篮子失败：No servers found yet, Timeout: 5.0s, Topology Description: &lt;TopologyDescription id: 6928fb0b1c85d8bff8680531, topology_type: Single, servers: [&lt;ServerDescription (&#39;192.168.1.142&#39;, 27017) server_type: Unknown, rtt: None&gt;]&gt;，10秒后重试</p><p>[2025-11-28 09:30:02][新建策略文件][SH000300][1分钟] 【MongoDB查询】时间：2025-11-28 09:30:02（重试11/18）</p><p>[2025-11-28 09:30:08][新建策略文件][SH000300][1分钟] 获取股票篮子失败：No servers found yet, Timeout: 5.0s, Topology Description: &lt;TopologyDescription id: 6928fb1a1c85d8bff8680532, topology_type: Single, servers: [&lt;ServerDescription (&#39;192.168.1.142&#39;, 27017) server_type: Unknown, rtt: None&gt;]&gt;，10秒后重试</p><p>[2025-11-28 09:30:18][新建策略文件][SH000300][1分钟] 【MongoDB查询】时间：2025-11-28 09:30:18（重试12/18）</p><p>[2025-11-28 09:30:23][新建策略文件][SH000300][1分钟] 获取股票篮子失败：No servers found yet, Timeout: 5.0s, Topology Description: &lt;TopologyDescription id: 6928fb2a1c85d8bff8680533, topology_type: Single, servers: [&lt;ServerDescription (&#39;192.168.1.142&#39;, 27017) server_type: Unknown, rtt: None&gt;]&gt;，10秒后重试</p><p>[2025-11-28 09:30:33][新建策略文件][SH000300][1分钟] 【MongoDB查询】时间：2025-11-28 09:30:33（重试13/18）</p><p>[2025-11-28 09:30:38][新建策略文件][SH000300][1分钟] 获取股票篮子失败：No servers found yet, Timeout: 5.0s, Topology Description: &lt;TopologyDescription id: 6928fb391c85d8bff8680534, topology_type: Single, servers: [&lt;ServerDescription (&#39;192.168.1.142&#39;, 27017) server_type: Unknown, rtt: None&gt;]&gt;，10秒后重试</p><p>[2025-11-28 09:30:48][新建策略文件][SH000300][1分钟] 【MongoDB查询】时间：2025-11-28 09:30:48（重试14/18）</p><p>[2025-11-28 09:30:54][新建策略文件][SH000300][1分钟] 获取股票篮子失败：No servers found yet, Timeout: 5.0s, Topology Description: &lt;TopologyDescription id: 6928fb481c85d8bff8680535, topology_type: Single, servers: [&lt;ServerDescription (&#39;192.168.1.142&#39;, 27017) server_type: Unknown, rtt: None&gt;]&gt;，10秒后重试</p><p>[2025-11-28 09:31:04][新建策略文件][SH000300][1分钟] 【MongoDB查询】时间：2025-11-28 09:31:04（重试15/18）</p><p>[2025-11-28 09:31:09][新建策略文件][SH000300][1分钟] 获取股票篮子失败：No servers found yet, Timeout: 5.0s, Topology Description: &lt;TopologyDescription id: 6928fb581c85d8bff8680536, topology_type: Single, servers: [&lt;ServerDescription (&#39;192.168.1.142&#39;, 27017) server_type: Unknown, rtt: None&gt;]&gt;，10秒后重试</p><p>[2025-11-28 09:31:19][新建策略文件][SH000300][1分钟] 【MongoDB查询】时间：2025-11-28 09:31:19（重试16/18）</p><p>[2025-11-28 09:31:24][新建策略文件][SH000300][1分钟] 获取股票篮子失败：No servers found yet, Timeout: 5.0s, Topology Description: &lt;TopologyDescription id: 6928fb671c85d8bff8680537, topology_type: Single, servers: [&lt;ServerDescription (&#39;192.168.1.142&#39;, 27017) server_type: Unknown, rtt: None&gt;]&gt;，10秒后重试</p><p>[2025-11-28 09:31:34][新建策略文件][SH000300][1分钟] 【MongoDB查询】时间：2025-11-28 09:31:34（重试17/18）</p><p>[2025-11-28 09:31:39][新建策略文件][SH000300][1分钟] 获取股票篮子失败：No servers found yet, Timeout: 5.0s, Topology Description: &lt;TopologyDescription id: 6928fb761c85d8bff8680538, topology_type: Single, servers: [&lt;ServerDescription (&#39;192.168.1.142&#39;, 27017) server_type: Unknown, rtt: None&gt;]&gt;，10秒后重试</p><p>[2025-11-28 09:31:49][新建策略文件][SH000300][1分钟] 【MongoDB查询】时间：2025-11-28 09:31:49（重试18/18）</p><p>[2025-11-28 09:31:55][新建策略文件][SH000300][1分钟] 获取股票篮子失败：No servers found yet, Timeout: 5.0s, Topology Description: &lt;TopologyDescription id: 6928fb851c85d8bff8680539, topology_type: Single, servers: [&lt;ServerDescription (&#39;192.168.1.142&#39;, 27017) server_type: Unknown, rtt: None&gt;]&gt;，10秒后重试</p><p>[2025-11-28 09:32:05][新建策略文件][SH000300][1分钟] 所有重试失败，未找到今日股票篮子 【竞价买入】MongoDB 未返回股票篮子，本日不再尝试</p><p>[2025-11-28 09:35:00][新建策略文件][SH000300][1分钟] [TIMER] timer_cancel_auction_buys fired</p><h1 id="竞价买入撤单流程启动-时间-09-35-00" tabindex="-1">======================================== 竞价买入撤单流程启动 时间：09:35:00 <a class="header-anchor" href="#竞价买入撤单流程启动-时间-09-35-00" aria-label="Permalink to &quot;========================================
竞价买入撤单流程启动  时间：09:35:00&quot;">​</a></h1><p>【竞价撤单】今日无策略竞价买入记录，跳过</p><p>[2025-11-28 14:56:00][新建策略文件][SH000300][1分钟] [TIMER] timer_cancel_open_sells fired</p><h1 id="_14-55-撤销卖出委托流程-时间-14-56-00" tabindex="-1">======================================== 14:55 撤销卖出委托流程 时间：14:56:00 <a class="header-anchor" href="#_14-55-撤销卖出委托流程-时间-14-56-00" aria-label="Permalink to &quot;========================================
14:55 撤销卖出委托流程  时间：14:56:00&quot;">​</a></h1><p>【查询当前持仓】账号：904800028165 当前持仓：[&#39;000859.SZ&#39;, &#39;301638.SZ&#39;]（共2只） 【撤单】准备撤单 | code=301638 | opt=限价卖出 | status=50 | order_id=MM944923 can_cancel: True</p><p>【撤销委托】股票：301638 | 委托ID=MM944923 委托撤销成功 【撤单】准备撤单 | code=000859 | opt=限价卖出 | status=50 | order_id=MM944924 can_cancel: True</p><p>【撤销委托】股票：000859 | 委托ID=MM944924 委托撤销成功 【撤单】尾盘撤单流程完成</p><p>[2025-11-28 14:57:00][新建策略文件][SH000300][1分钟] [TIMER] timer_afternoon_sell fired</p><h1 id="尾盘卖出流程启动-时间-14-57-00" tabindex="-1">======================================== 尾盘卖出流程启动 时间：14:57:00 <a class="header-anchor" href="#尾盘卖出流程启动-时间-14-57-00" aria-label="Permalink to &quot;========================================
尾盘卖出流程启动  时间：14:57:00&quot;">​</a></h1><p>【查询当前持仓】账号：904800028165 当前持仓：[&#39;000859.SZ&#39;, &#39;301638.SZ&#39;]（共2只）</p><p>【计算涨跌停价】股票：000859.SZ 前收盘价=8.47元 | 涨停价=9.31元 | 跌停价=7.63元</p><p>【卖出挂单】股票：000859.SZ | 价格=7.63元 | 股数=900 【获取最新委托ID】账号：904800028165 成功获取最新委托ID：MM636103 卖出挂单成功 | 委托ID=MM636103 【尾盘卖出】000859.SZ 挂单 | 跌停价=7.63元 | 股数=900</p><p>【计算涨跌停价】股票：301638.SZ 前收盘价=25.75元 | 涨停价=28.32元 | 跌停价=23.18元</p><p>【卖出挂单】股票：301638.SZ | 价格=23.18元 | 股数=300 【获取最新委托ID】账号：904800028165 成功获取最新委托ID：MM636103 卖出挂单成功 | 委托ID=MM636103 【尾盘卖出】301638.SZ 挂单 | 跌停价=23.18元 | 股数=300 【尾盘卖出】批量挂单完成</p><h2 id="问题-4" tabindex="-1">问题 <a class="header-anchor" href="#问题-4" aria-label="Permalink to &quot;问题&quot;">​</a></h2><ol><li>mongodb的链接是局域网，在我的台式机上无法连接，导致股票获取失败；</li></ol><hr><h1 id="_12月1日" tabindex="-1">12月1日 <a class="header-anchor" href="#_12月1日" aria-label="Permalink to &quot;12月1日&quot;">​</a></h1><h2 id="日志-7" tabindex="-1">日志 <a class="header-anchor" href="#日志-7" aria-label="Permalink to &quot;日志&quot;">​</a></h2><p>[2025-12-01 09:08:23][新建策略文件][SH000300][1分钟] [trade]start trading mode [2025-12-01 09:08:23][新建策略文件][SH000300][1分钟] ================================================================================ 【实盘买入策略启动】时间：2025-12-01 09:08:23 配置信息：</p><ul><li>MongoDB：192.168.1.142:27017/?authSource=stock/stock/ths_realtime_stocks</li><li>交易账号：904800028165</li><li>买入规则：竞价价×1.02（向下取整），资金均分</li><li>卖出规则：次日9:30开盘价×1.091挂单，14:55未卖撤单，14:57跌停价卖出 ================================================================================</li></ul><p>[2025-12-01 09:25:00][新建策略文件][SH000300][1分钟] [TIMER] timer_morning_sell fired</p><h1 id="早盘卖出流程启动-时间-09-25-00-1" tabindex="-1">======================================== 早盘卖出流程启动 时间：09:25:00 <a class="header-anchor" href="#早盘卖出流程启动-时间-09-25-00-1" aria-label="Permalink to &quot;========================================
早盘卖出流程启动  时间：09:25:00&quot;">​</a></h1><p>【查询当前持仓】账号：904800028165 当前持仓：[&#39;301638.SZ&#39;]（共1只） 【早盘卖出】301638.SZ 基准价=24.72 * 1.191 -&gt; 卖出价=29.44元</p><p>【卖出挂单】股票：301638.SZ | 价格=29.44元 | 股数=300 【获取最新委托ID】账号：904800028165 未获取到最新委托ID（返回值：-1） 卖出挂单成功，但未获取到委托ID 【早盘卖出】批量挂单结束</p><h2 id="问题-5" tabindex="-1">问题 <a class="header-anchor" href="#问题-5" aria-label="Permalink to &quot;问题&quot;">​</a></h2><ol><li>早盘卖出挂单，未获取到委托id</li><li>更改了选票策略的地址： <ol><li>改为118.xxx的公网IP；</li><li>改为daily_stocks的数据库；</li></ol></li></ol><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 原始用户名和密码（可能包含特殊字符）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    remote_username </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;zheng123&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 替换为实际用户名</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    remote_password </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Jack@1357&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 替换为实际密码（可能包含@、:等特殊字符）</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 替换为实际的用户名和密码</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    cloud_collection </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MongoClient(</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;mongodb://</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">encoded_username</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">encoded_password</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">@118.196.11.76:27017/&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        serverSelectionTimeoutMS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;stock&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;daily_stocks&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 对用户名和密码进行URL编码</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    encoded_username </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> quote_plus(remote_username)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    encoded_password </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> quote_plus(remote_password)</span></span></code></pre></div><hr><h1 id="todo" tabindex="-1">TODO <a class="header-anchor" href="#todo" aria-label="Permalink to &quot;TODO&quot;">​</a></h1><ol><li>9:25挂卖单逻辑，根据买一和卖一的价和量，得到未匹配量，然后根据当前价格和未匹配量，判断是否挂卖单；</li></ol>`,215)])])}const S=t(r,[["render",a]]);export{g as __pageData,S as default};
